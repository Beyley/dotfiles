#global defines
$lockCommand = hyprlock --immediate

# Monitor definitions
monitor=HDMI-A-1,1920x1080@60,0x0,1
# monitor=HDMI-A-1,1920x1080@60,0x0,1,bitdepth,10
# monitor=DP-2,3440x1440@165,1920x120,1,bitdepth,10
monitor=DP-2,3440x1440@165,1920x120,1
monitor=DP-3,1280x1024@75,5360x120,1,transform,1
# monitor=DP-3,1280x1024@75,5360x120,1
# monitor=DP-3,1280x1024@75,5360x120,1,transform,1,bitdepth,10

# Workspaces for main monitor
workspace=1,monitor:DP-2
workspace=2,monitor:DP-2
workspace=3,monitor:DP-2
workspace=4,monitor:DP-2
workspace=5,monitor:DP-2
workspace=6,monitor:DP-2
workspace=7,monitor:DP-2
workspace=8,monitor:DP-2
workspace=9,monitor:DP-2
# Workspaces for right monitor
workspace=11,monitor:DP-3,rounding:false,border:false,gapsout:0,gapsin:0,default:true
workspace=12,monitor:DP-3,rounding:false,border:false,gapsout:0,gapsin:0,default:true
workspace=13,monitor:DP-3,rounding:false,border:false,gapsout:0,gapsin:0,default:true
workspace=14,monitor:DP-3,rounding:false,border:false,gapsout:0,gapsin:0,default:true
workspace=15,monitor:DP-3,rounding:false,border:false,gapsout:0,gapsin:0,default:true
workspace=16,monitor:DP-3,rounding:false,border:false,gapsout:0,gapsin:0,default:true
workspace=17,monitor:DP-3,rounding:false,border:false,gapsout:0,gapsin:0,default:true
workspace=18,monitor:DP-3,rounding:false,border:false,gapsout:0,gapsin:0,default:true
workspace=19,monitor:DP-3,rounding:false,border:false,gapsout:0,gapsin:0,default:true
# Workspaces for left montior
workspace=21,monitor:HDMI-A-1,rounding:false,border:false,gapsout:0,gapsin:0,default:true
workspace=22,monitor:HDMI-A-1,rounding:false,border:false,gapsout:0,gapsin:0,default:true
workspace=23,monitor:HDMI-A-1,rounding:false,border:false,gapsout:0,gapsin:0,default:true
workspace=24,monitor:HDMI-A-1,rounding:false,border:false,gapsout:0,gapsin:0,default:true
workspace=25,monitor:HDMI-A-1,rounding:false,border:false,gapsout:0,gapsin:0,default:true
workspace=26,monitor:HDMI-A-1,rounding:false,border:false,gapsout:0,gapsin:0,default:true
workspace=27,monitor:HDMI-A-1,rounding:false,border:false,gapsout:0,gapsin:0,default:true
workspace=28,monitor:HDMI-A-1,rounding:false,border:false,gapsout:0,gapsin:0,default:true
workspace=29,monitor:HDMI-A-1,rounding:false,border:false,gapsout:0,gapsin:0,default:true

# Force discord onto right monitor 
windowrulev2=workspace 11,class:vesktop
# Force dev tools onto dev workspace
windowrulev2=workspace 1,class:^(jetbrains\-)
windowrulev2=workspace 1,class:code
# Force kitty onto terminal workspace
windowrulev2=workspace 2,class:kitty
# Force firefox onto browser workspace
windowrulev2=workspace 3,class:firefox-nightly
# Put ghidra, anki, and bitwarden onto other workspace.
windowrulev2=workspace 4,class:ghidra-Ghidra
windowrulev2=workspace 4,class:anki
windowrulev2=workspace 4,class:Bitwarden

windowrulev2=workspace 5,class:thunderbird

windowrulev2=workspace 6,class:^(steam),floating:0

# Make anki and rpcs3 float
windowrulev2=float,class:anki
windowrulev2=float,class:rpcs3
windowrulev2=center 1,class:anki
windowrulev2=center 1,class:rpcs3

# Force certain apps/windows to not become transparent
windowrulev2=opaque,class:vesktop
windowrulev2=opaque,title:(.*)(- YouTube)(.*)

# Force kitty to always be more transparent
windowrulev2=opacity 0.8,class:kitty

windowrulev2 = immediate, class:^(gamescope)$
windowrulev2 = immediate, class:^(Barotrauma)$
windowrulev2 = immediate, class:^(steam_app_1422450)$
windowrulev2 = immediate, class:^(Minecraft 1.6.4)$
windowrulev2 = immediate, class:^(osu!)$
# windowrulev2 = immediate, class:^(steam_app_1017180)$


# exec-once = /usr/lib/polkit-kde-authentication-agent-1

# Activate the dbus environment
exec-once = dbus-update-activation-environment --systemd WAYLAND_DISPLAY XDG_CURRENT_DESKTOP

exec-once = hyprctl setcursor Patchouli 32 # Set custom cursor 
exec-once = gsettings set org.gnome.desktop.interface cursor-theme Patchouli # Tell GTK apps to use custom cursor
env = XCURSOR_SIZE,32 # Explicitly tell apps our cursor is size 32

exec = gsettings set org.gnome.desktop.interface color-scheme "prefer-dark" # Tell GTK-4 apps to use dark mode
exec = gsettings set org.gnome.desktop.interface gtk-theme "Breeze-Dark" # Tell GTK-3 apps to use dark mode
env = QT_QPA_PLATFORMTHEME,qt6ct # Make QT apps use the qt6ct theme, eg. dark theme


env = QT_IM_MODULE,fcitx # Tell QT apps to use fcitx
env = XMODIFIERS=@im,fcitx # Tell generic X apps to use fcitx
env = SDL_IM_MODULE,fcitx # Tell SDL to use fcitx
env = GLFW_IM_MODULE,ibus # Tell GLFW to use the IME through ibus

env = MOZ_ENABLE_WAYLAND,1 # Tell Firefox to use native Wayland
env = ELECTRON_OZONE_PLATFORM_HINT,wayland # Hint electron apps to use native wayland
env = GDK_BACKEND,wayland,x11,* # Make GTK apps prefer wayland
env = QT_QPA_PLATFORM,wayland;xcb # Make QT apps prefer wayland
env = CLUTTER_BACKEND,wayland # Make Clutter use wayland
env = QT_WAYLAND_DISABLE_WINDOWDECORATION,1 # Disable QT app window decorations
# env = SDL_VIDEODRIVER,wayland # Make SDL use the wayland video driver

env = XDG_MENU_PREFIX,plasma- # Attempt to fix dolphin icons/file associations

# Set the current desktop to hyprland forcefully
env = XDG_CURRENT_DESKTOP,Hyprland
env = XDG_SESSION_TYPE,wayland
env = XDG_SESSION_DESKTOP,Hyprland

exec-once = hypridle # Hypridle
exec-once = kwalletd5 # kwallet
exec-once = fcitx5 # IME
exec-once = mako # notification daemon
exec-once = wl-paste --type text --watch cliphist store # Store history for text clipboard data
exec-once = wl-paste --type image --watch cliphost store # Store history for image cliboard data

# Start default apps
exec-once = waybar # Bar
exec-once = vesktop # Discord
exec-once = firefox-nightly
exec-once = kitty
exec-once = kitty
exec-once = /usr/lib/pam_kwallet_init
exec-once = thunderbird
exec-once = jetbrains-toolbox
exec-once = bitwarden-desktop
exec-once = systemctl --user start hyprpolkitagent
# exec-once = /home/beyley/start-portal.sh

general {
    gaps_in = 5 # Minimal gaps between windows
    gaps_out = 10 # Minimal gaps around windows
    border_size = 2 # Thin border
    col.active_border = rgba(a502e0ee) rgba(8f11bdee) 45deg # Purple colours c: #A502E0, #8F11BD
    col.inactive_border = rgba(595959aa) # Dark grey inactive border #595959
    allow_tearing = true # Allow screen tearing
    layout = dwindle # Use the dwindle layout
}

decoration {
    rounding = 5 # Minor rounding
    
    blur {
        enabled = false # Disable blur
    }

    drop_shadow = true # Give windows a drop shadow
    shadow_range = 4 # Small shadow
    shadow_render_power = 3 # Fast falloff
    col.shadow = rgba(1a1a1aee) # Black shadow #1a1a1a
}

animations {
    enabled = yes

    bezier = myBezier, 0.05, 0.9, 0.1, 1.05

    animation = windows, 1, 7, myBezier
    animation = windowsOut, 1, 7, default, popin 80%
    animation = border, 1, 10, default
    animation = borderangle, 1, 8, default
    animation = fade, 1, 7, default
    animation = workspaces, 1, 6, default
}

input {
    kb_layout = us
    kb_variant = workman
    numlock_by_default = true
    follow_mouse = 1 # Cursor movement always changes focus to window below cursor
    sensitivity = -0.4
    tablet {
        output = HDMI-A-1
        region_size = 5544, 1560
        region_position = 0, 0
    }
}

dwindle {
    pseudotile = yes # Attempts to tile floating windows, they retain their size when tiled
    preserve_split = yes
}

master {
}

misc {
  vrr = 1
  force_default_wallpaper = 3
  # render_ahead_of_time = true # Reduce latency by starting rendering before the monitor is ready to show it
  allow_session_lock_restore = true # Fix red screen of death
  key_press_enables_dpms = true # Turn on monitors on key press
  middle_click_paste = false # Disable middle click paste because that shit sucks
}

render {
  explicit_sync = 1 # Force-enable explicit sync
  direct_scanout = true # Enable direct scanout for fullscreen applications
}

cursor {
  hide_on_key_press = true # hide the cursor when typing
  inactive_timeout = 10 # hide the cursor after some set inactivity
  no_warps = true # Disable cursor warping to opened windows and such
}

debug {
  # overlay = true # Frame timings overlay
  # damage_blink = true # Blink damaged areas
  error_position = 1 # Move the error bar to the bottom to not interfere with waybar
  # disable_logs = false # Enable logs
}

plugin {
  hyprtrails {
    color = rgba(aa00ffaa) # Purple window movement trails #AA00FF
  }
}

$mainMod = SUPER # Super is the main modifier

bind = $mainModSHIFT, M, exit, # Exit the compositor

bind = $mainMod, L, exec, $lockCommand # lock command

bind = $mainMod, Q, exec, kitty # Spawn terminal
bind = $mainMod, E, exec, dolphin # Spawn file manager

bind = $mainMod, SPACE, exec, tofi-drun | xargs hyprctl dispatch exec -- # Run apps
bind = $mainMod, H, exec, cliphist list | tofi | cliphist decode | wl-copy # List clipboard
bind = $mainModSHIFT, H, exec, /home/beyley/.embedfix.sh # Fixup embeds/URLs

#Window controls
bind = $mainMod, C, killactive, # Kill active window
bind = $mainMod, G, togglegroup, # Toggle grouping for window
bind = $mainMod, Tab, changegroupactive, # Change which group member is active
bind = $mainMod, V, togglefloating, # Toggle a window as floating
bind = $mainMod, P, pseudo, # Enable the specfic window to be psuedo-tiled
bind = $mainMod, J, togglesplit, # Toggle between a horizontal and vertical split

bind = $mainMod, F, fullscreen, 1 # Make app take up the whole workspace
bind = $mainModSHIFT, F, fullscreen, 2 # Make app take up the whole screen

bind = $mainMod, left, movefocus, l # Move keyboard focus left
bind = $mainMod, right, movefocus, r # Move keyboard focus right
bind = $mainMod, up, movefocus, u # Move keyboard focus up
bind = $mainMod, down, movefocus, d # Move keyboard focus down

bindm = $mainMod, mouse:272, movewindow # Move window using SUPER + Lclick
bindm = $mainMod, mouse:273, resizewindow # Resize window with SUPER + Rclick

# Switch workspaces with SUPER + [0-9]
bind = $mainMod, 1, exec, hyprsome workspace 1
bind = $mainMod, 2, exec, hyprsome workspace 2
bind = $mainMod, 3, exec, hyprsome workspace 3
bind = $mainMod, 4, exec, hyprsome workspace 4
bind = $mainMod, 5, exec, hyprsome workspace 5
bind = $mainMod, 6, exec, hyprsome workspace 6
bind = $mainMod, 7, exec, hyprsome workspace 7
bind = $mainMod, 8, exec, hyprsome workspace 8
bind = $mainMod, 9, exec, hyprsome workspace 9

# Move active window to a workspace with SUPER + SHIFT + [0-9]
bind = $mainModSHIFT, 1, exec, hyprsome move 1 && hyprsome workspace 1
bind = $mainModSHIFT, 2, exec, hyprsome move 2 && hyprsome workspace 2
bind = $mainModSHIFT, 3, exec, hyprsome move 3 && hyprsome workspace 3
bind = $mainModSHIFT, 4, exec, hyprsome move 4 && hyprsome workspace 4
bind = $mainModSHIFT, 5, exec, hyprsome move 5 && hyprsome workspace 5
bind = $mainModSHIFT, 6, exec, hyprsome move 6 && hyprsome workspace 6
bind = $mainModSHIFT, 7, exec, hyprsome move 7 && hyprsome workspace 7
bind = $mainModSHIFT, 8, exec, hyprsome move 8 && hyprsome workspace 8
bind = $mainModSHIFT, 9, exec, hyprsome move 9 && hyprsome workspace 9

bind = , Print, exec, /home/beyley/screenshot.sh area # Screenshot selected area 
bind = Shift, Print, exec, /home/beyley/screenshot.sh active # Screenshot active window
bind = Ctrl, Print, exec, /home/beyley/screenshot.sh output # Screenshot active monitor
bind = CtrlShift, Print, exec, hyprpicker -t -r -a -f hex # Colour picker, copies to clipboard as hex

bindel = ,XF86AudioRaiseVolume, exec, wpctl set-volume @DEFAULT_AUDIO_SINK@ 5%+ # Volume up
bindel = ,XF86AudioLowerVolume, exec, wpctl set-volume @DEFAULT_AUDIO_SINK@ 5%- # Volume down
bindel = ,XF86AudioMute, exec, wpctl set-mute @DEFAULT_AUDIO_SINK@ toggle # Mute audio
bindel = ,XF86AudioMicMute, exec, wpctl set-mute @DEFAULT_AUDIO_SOURCE@ toggle # Mute mic
